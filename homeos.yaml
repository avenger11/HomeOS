#..............................................................................
#.HHHH...HHHH.........................................OOOOOOO......SSSSSSS.....
#.HHHH...HHHH........................................OOOOOOOOOO...OSSSSSSSS....
#.HHHH...HHHH.......................................eOOOOOOOOOOO..OSSSSSSSSS...
#.HHHH...HHHH....oooooo..ommmmmmmmmmmmm....eeeeee...eOOOO..OOOOO.OOSSS..SSSS...
#.HHHH...HHHH..ooooooooo.ommmmmmmmmmmmmm..eeeeeeee.eeOOO....OOOOOOOSSS.........
#.HHHHHHHHHHH..oooo.oooooommmm.mmmmmmmmm.meee.eeee.eeOO......OOOO.OSSSSSS......
#.HHHHHHHHHHH.Hooo...ooooommm..mmmm..mmmmmeee..eeeeeeOO......OOOO..SSSSSSSSS...
#.HHHHHHHHHHH.Hooo...ooooommm..mmmm..mmmmmeeeeeeeeeeeOO......OOOO....SSSSSSS...
#.HHHH...HHHH.Hooo...ooooommm..mmmm..mmmmmeeeeeeeeeeeOOO....OOOOO.......SSSSS..
#.HHHH...HHHH.Hooo...ooooommm..mmmm..mmmmmeee.......eOOOO..OOOOO.OOSS....SSSS..
#.HHHH...HHHH..oooo.oooooommm..mmmm..mmmmmeee..eeee.eOOOOOOOOOOO.OOSSSSSSSSSS..
#.HHHH...HHHH..ooooooooo.ommm..mmmm..mmmm.eeeeeeee...OOOOOOOOOO...OSSSSSSSSS...
#.HHHH...HHHH....oooooo..ommm..mmmm..mmmm..eeeeee......OOOOOO......SSSSSSSS....
#..............................................................................
# +----------------------------------------------------------------------------+
# | Description:                                                               |
# | This is the main file for the HomeOS dashboard                             |
# +----------------------------------------------------------------------------+
# | Author: Sebastien Logeais                                                  |
# +----------------------------------------------------------------------------+
# | Date: 21 October 2023                                                      |
# +----------------------------------------------------------------------------+

# ==============================================================================
# |          ====> THIS IS THE SECTION TO CHANGE YOUR ENTITY  <=====           |
# | Change only 'xxxx.xxxx '                                                   |
# ==============================================================================
homeos_configuration:


# Apps Bar
# +----------+--------------------+-------------------------------------------+
# | Name     | Anchor Name        | Entity or icon svg to change              |
# +----------+--------------------+-------------------------------------------+
  climate:    &config_climate       'climate.entryway'
  alarm:      &config_alarm         'alarm_control_panel.alarmo'
  apps1:      &config_apps1         'group.docker_update'
  apps1_icon: &config_apps1_icon    '/local/homeos/appsbar_media/icon_docker.jpg'

# Scene Configuration
# +---+---+
# | 1 | 2 |
# +---+---+
# | 3 | 4 |
# +---+---+
#
# +----------+--------------------+-------------------------------------------+
# | Name     | Anchor Name        | Entity or icon svg to change              |
# +----------+--------------------+-------------------------------------------+
  scene1:       &config_scene1       'input_boolean.homeos_scene_clara_aux_dodo'
  scene1_icon:  &config_scene1_icon  'icon_moon_stars_fill'

  scene2:       &config_scene2       'input_boolean.homeos_scene_invite'
  scene2_icon:  &config_scene2_icon  'icon_wineglass_fill'

  scene3:       &config_scene3        'input_boolean.homeos_scene_morning_coffee'
  scene3_icon:  &config_scene3_icon   'icon_cup_saucer_fill'

  scene4:       &config_scene4        'input_boolean.homeos_scene_morning_coffee'
  scene4_icon:  &config_scene4_icon   'icon_empty'

# Garbage Card Configuration
  garbage:      &config_garbage       'schedule.garbage'
  recyling:     &config_recycling     'schedule.recycle'


# Person Card 
  person_bus:   &config_person_bus    'person.lynn'
  bus_route:    &config_bus_route     'sensor.491_express_est'
  person_car:   &config_person_car    'person.seb'
  travel_home:  &config_travel_home   'sensor.seb_iphone_travel_time'
  travel_work:  &config_travel_work   'sensor.seb_to_work'


# Plant Card 1
  plant_1:      &config_plant_1       'plant.pin_de_norfolks'
  hum_plant_1:  &config_hum_plant_1   'sensor.pin_de_norfolks_soil_moisture'
  min_plant_1:  &config_min_plant_1   'number.pin_de_norfolks_min_soil_moisture'
  
# Plant Card 2
  plant_2:      &config_plant_2       'plant.anthurium_2'
  hum_plant_2:  &config_hum_plant_2   'sensor.anthurium_soil_moisture_2'
  min_plant_2:  &config_min_plant_2   'number.anthurium_min_soil_moisture_2'

# ==============================================================================
# | Do not change code after this box                                          |
# ==============================================================================

kiosk_mode:
  hide_header: true

# all relevant template will be find
button_card_templates: !include_dir_merge_named homeos_module/


decluttering_templates:
  light:
    card:
      type: custom:button-card
      entity: '[[entity]]'
      tap_action: 
        action: fire-dom-event
        browser_mod:
          service: browser_mod.popup
          data:
            content:      
              type: custom:button-card
              entity: '[[entity2]]'  
views:
# +----------------------------------------------------------------------------+
# | Definition of the first grid-layout                                        |
# | +------+----------------------------------+                                |
# | |      |           2 topbar               |                                |
# | |   1  +----------------------------------+                                |
# | | Apps |                                  |                                |
# | |      |           3 grid                 |                                |
# | |      |                                  |                                |
# | +------+----------------------------------+                                |
# +----------------------------------------------------------------------------+
  - type: custom:grid-layout
    title: HomeOS
    background: var(--background)
    layout:
      height: var(--homeos-screen-height)
      margin: 0
      grid-template-columns: var(--homeos-appsbar-width) 1fr 
      grid-template-rows: var(--homeos-topbar-height) 1fr 
      grid-gap: 0
      grid-template-areas: |
        "apps topbar "
        "apps cards"
    cards:

#...............................................................................
#.....AAAAA.....PPPPPPPPP...PPPPPPPPP...BBBBBBBBBB......AAAAA.....RRRRRRRRRR....
#.....AAAAA.....PPPPPPPPPP..PPPPPPPPPP..BBBBBBBBBBB.....AAAAA.....RRRRRRRRRRR...
#....AAAAAA.....PPPPPPPPPPP.PPPPPPPPPPP.BBBBBBBBBBB....AAAAAA.....RRRRRRRRRRR...
#....AAAAAAA....PPPP...PPPP.PPPP...PPPP.BBBB...BBBB....AAAAAAA....RRRR...RRRRR..
#...AAAAAAAA....PPPP...PPPP.PPPP...PPPP.BBBB...BBBB...AAAAAAAA....RRRR...RRRRR..
#...AAAAAAAA....PPPPPPPPPPP.PPPPPPPPPPP.BBBBBBBBBBB...AAAAAAAA....RRRRRRRRRRR...
#...AAAA.AAAA...PPPPPPPPPP..PPPPPPPPPP..BBBBBBBBBB....AAAA.AAAA...RRRRRRRRRRR...
#..AAAAAAAAAA...PPPPPPPPP...PPPPPPPPP...BBBBBBBBBBB..AAAAAAAAAA...RRRRRRRR......
#..AAAAAAAAAAA..PPPP........PPPP........BBBB....BBBB.AAAAAAAAAAA..RRRR.RRRR.....
#..AAAAAAAAAAA..PPPP........PPPP........BBBB....BBBB.AAAAAAAAAAA..RRRR..RRRR....
#.AAAA....AAAA..PPPP........PPPP........BBBBBBBBBBBBBAAA....AAAA..RRRR..RRRRR...
#.AAAA.....AAAA.PPPP........PPPP........BBBBBBBBBBB.BAAA.....AAAA.RRRR...RRRRR..
#.AAAA.....AAAA.PPPP........PPPP........BBBBBBBBBB.BBAAA.....AAAA.RRRR....RRRR..
#...............................................................................
# +---+------------------------------------------------------------------------+
# | 1 | Definition of the Apps Bar                                             |
# +---+------------------------------------------------------------------------+
      - type: picture-elements
        view_layout:
          grid-area: apps  
        image: /local/homeos/empty.png
        card_mod:
          style: |
            ha-card {
              border-radius: 0;
              border-top-left-radius: var(--homeos-card-border-radius);
              border-bottom-left-radius: var(--homeos-card-border-radius);
              --ha-card-background: var(--homeos-card-background);
              backdrop-filter: var(--homeos-card-backdrop-filter);
              --ha-card-border-color: rgba(0, 0, 0, 0);
              --ha-card-border-width: 0px;
            }
            :host {
              height: var(--homeos-screen-height);
              margin: 0px !important;
            }
        elements:

# +----------------------------------------------------------------------------+
# | Element are placed in order from top to bottom of the screen               |
# +----------------------------------------------------------------------------+       
          - type: custom:button-card
            entity: *config_climate
            template: template_climate
            style:
              top: 3vw
              left: calc(var(--homeos-appsbar-width) / 2 + 0.3vw)

          - type: custom:button-card
            entity: *config_alarm
            template:
              - icon_shield_fill
              - template_system_icon
            style:
              left: calc(var(--homeos-appsbar-width) / 2)
              top: 8vw
            styles: # Override normal setting to make the icon smaller
              custom_fields:
                icon: 
                  - width: calc( var(--homeos-appsbar-width) - 2.5vw)
     
          - type: custom:hui-element
            card_type: vertical-stack
            style:
              top: 30vw
              left: calc(var(--homeos-appsbar-width) / 2)
            cards:

              # Separator
              # - type: custom:button-card
              #   template: template_apps_separator

              - type: custom:button-card
                entity: *config_apps1
                entity_picture: *config_apps1_icon
                template:
                  - template_apps_icon

          - type: custom:button-card
            style:
              left: calc(var(--homeos-appsbar-width) / 2)
              top: 55vw
            styles: # Override normal setting to make the icon bigger
              custom_fields:
                icon: 
                  - width: calc( var(--homeos-appsbar-width) - 1.5vw)
            template:
              - icon_setting_fill
              - template_system_icon
            tap_action: !include homeos_module/appsbar/appsbar_setting_popup.yaml
              
          - type: custom:button-card
            style:
              left: calc(var(--homeos-appsbar-width) / 2)
              top: 60vw
            template:
              - icon_gearshape_fill
              - template_system_icon
            tap_action:
              action: navigate
              navigation_path: /config/integrations/dashboard

#.............................................................................
#.TTTTTTTTTTT..OOOOOOO....OPPPPPPPPP..PPBBBBBBBBB......AAAA.....ARRRRRRRRRR...
#.TTTTTTTTTTT.OOOOOOOOOO..OPPPPPPPPPP.PPBBBBBBBBBB....AAAAAA....ARRRRRRRRRRR..
#.TTTTTTTTTTTOOOOOOOOOOOO.OPPPPPPPPPPPPPBBBBBBBBBB....AAAAAA....ARRRRRRRRRRR..
#....TTTT...TOOOO...OOOOO.OPPP....PPPPPPBB....BBBB....AAAAAAA...ARRR....RRRR..
#....TTTT...TOOO.....OOOOOOPPP....PPPPPPBB....BBBB...AAAAAAAA...ARRR....RRRR..
#....TTTT...TOOO......OOOOOPPPPPPPPPPPPPBBBBBBBBBB...AAAAAAAA...ARRRRRRRRRRR..
#....TTTT...TOOO......OOOOOPPPPPPPPPP.PPBBBBBBBBB....AAAA.AAAA..ARRRRRRRRRR...
#....TTTT...TOOO......OOOOOPPPPPPPPP..PPBBBBBBBBBB..BAAAAAAAAA..ARRRRRRRR.....
#....TTTT...TOOO.....OOOOOOPPP........PPBB.....BBBB.BAAAAAAAAAA.ARRR.RRRRR....
#....TTTT...TOOOOO..OOOOO.OPPP........PPBB.....BBBBBBAAAAAAAAAA.ARRR..RRRRR...
#....TTTT....OOOOOOOOOOOO.OPPP........PPBBBBBBBBBBBBBAA....AAAA.ARRR...RRRRR..
#....TTTT.....OOOOOOOOOO..OPPP........PPBBBBBBBBBB.BBAA....AAAAAARRR....RRRR..
#....TTTT......OOOOOOO....OPPP........PPBBBBBBBBB.BBBAA.....AAAAARRR.....RRR..
#.............................................................................
# +---+------------------------------------------------------------------------+
# | 2 | Definition of the top Bar                                              |
# +---+------------------------------------------------------------------------+    
      - type: custom:mod-card
        style: |
          :host {
            margin: 0.4vw 0 0 0.5vw !important;
          }
        card:
          type: horizontal-stack
          view_layout:
            grid_area: topbar
          cards:
            - type: custom:button-card
              entity: sensor.temperature_min_max
              template:
                - template_topbar
                - icon_topbar_thermometer
                
            - type: custom:button-card
              entity: sensor.humidity_min_max
              template:
                - template_topbar
                - icon_topbar_humidity

            - type: custom:button-card
              entity: sensor.lights_on_count
              template:
                - template_topbar
                - icon_topbar_lightbulb  

            - type: custom:button-card
              entity: sensor.security_status
              template:
                - template_topbar
                - icon_topbar_security  

            - type: custom:button-card
              entity: sensor.battery_min_max
              template:
                - template_topbar
                - icon_topbar_battery  

#................................................
#.....GGGGGGG....RRRRRRRRRR..IIIII.DDDDDDDDD.....
#...GGGGGGGGGG...RRRRRRRRRRR.IIIII.DDDDDDDDDD....
#..GGGGGGGGGGGG..RRRRRRRRRRR.IIIII.DDDDDDDDDDD...
#..GGGGG..GGGGG..RRRR...RRRRRIIIII.DDDD...DDDD...
#.GGGGG....GGG...RRRR...RRRRRIIIII.DDDD....DDDD..
#.GGGG...........RRRRRRRRRRR.IIIII.DDDD....DDDD..
#.GGGG..GGGGGGGG.RRRRRRRRRRR.IIIII.DDDD....DDDD..
#.GGGG..GGGGGGGG.RRRRRRRR....IIIII.DDDD....DDDD..
#.GGGGG.GGGGGGGG.RRRR.RRRR...IIIII.DDDD....DDDD..
#..GGGGG....GGGG.RRRR..RRRR..IIIII.DDDD...DDDDD..
#..GGGGGGGGGGGG..RRRR..RRRRR.IIIII.DDDDDDDDDDD...
#...GGGGGGGGGG...RRRR...RRRRRIIIII.DDDDDDDDDD....
#.....GGGGGGG....RRRR....RRRRIIIII.DDDDDDDDD.....
#................................................
# +---+------------------------------------------------------------------------+
# | 3 | Definition of the second custom grid layout                            |
# +---+------------------------------------------------------------------------+
      - type: custom:mod-card
        style: |
          :host {
            margin: 0px !important;
          }
        card:
          type: custom:layout-card
          layout_type: custom:grid-layout
          view_layout:
            grid_area: cards
          layout:
            card_margin: 0px
            height: calc( var(--homeos-screen-height) - var(--homeos-topbar-height) - 2*(var(--homeos-card-grid-gap)))
            grid-template-columns: repeat(8,var(--homeos-card-grid-square))
            grid-template-rows: repeat(5,var(--homeos-card-grid-square))
            grid-gap: var(--homeos-card-grid-gap)
            margin: 0
            padding: var(--homeos-card-grid-gap)
            grid-template-areas: |
              "weather  weather  map map map map person_car person_bus"
              "weather  weather  map map map map garbage washer"
              "weather  weather  map map map map . plant"
              "calendar calendar map map map map 4 test"
              "calendar calendar clock box box scene . 5"

          cards:


# +----------------------------------------------------------------------------+wedc
# | Weather Area Definition                                                    |
# +----------------------------------------------------------------------------+
            - type: custom:mod-card 
              view_layout:
                grid-area: weather
              # the following style ensure the card resize to the grid
              style: |
                ha-card {
                  display: contents;   
                }
                :host {
                  margin: 0px !important;
                }
              card: !include homeos_module/weather/weather_card.yaml  
    
    
    
# +----------------------------------------------------------------------------+
# | Calendar Area Definition                                                   |
# +----------------------------------------------------------------------------+
            - type: custom:mod-card
              view_layout:
                grid-area: calendar
              card_mod: 
                style: |
                  ha-card {
                    display: contents;   
                  }
                  :host {
                    margin: 0px !important;
                  }
                  button-card {
                    height: 100% !important;
                  }
              card: !include homeos_module/calendar/calendar_card.yaml

# +----------------------------------------------------------------------------+
# | Map Area Definition                                                        |
# +----------------------------------------------------------------------------+
            - type: custom:mod-card
              view_layout:
                grid-area: map
              style: |
                ha-card {
                  display: contents;   
                }
                :host {
                  margin: 0px !important;
                }
              card: !include homeos_module/map/map_card.yaml      

# +----------------------------------------------------------------------------+
# | Scene Area Definition                                                      |
# +----------------------------------------------------------------------------+
            - type: custom:mod-card
              view_layout:
                grid-area: scene
              style: |
                ha-card {
                  background: var(--homeos-card-background);
                  backdrop-filter: var(--homeos-card-backdrop-filter);
                  border-radius: var(--homeos-card-border-radius);
                  box-shadow: var(--homeos-card-box-shadow);
                  border-style: var(--homeos-card-border-style);
                  border-color: var(--homeos-card-border-color);
                  border-width: 1px;
                
                  --grid-card-gap: 0.8vw !important;
                  padding: 0.8vw;
                }
                :host {
                  margin: 0px !important;
                }
              card:
                  type: grid
                  columns: 2
                  cards:
                    - type: custom:button-card
                      entity: *config_scene1
                      template:
                        - *config_scene1_icon
                        - template_scene

                    - type: custom:button-card
                      entity: *config_scene2
                      template:
                        - *config_scene2_icon
                        - template_scene

                    - type: custom:button-card
                      entity: *config_scene3
                      template:
                        - *config_scene3_icon
                        - template_scene

                    - type: custom:button-card
                      entity: *config_scene4
                      template:
                        - *config_scene4_icon
                        - template_scene

               
# +----------------------------------------------------------------------------+
# | Garbage Area Definition                                                    |
# +----------------------------------------------------------------------------+
            - type: custom:mod-card
              view_layout:
                grid-area: garbage
              style: |
                ha-card {
                  --grid-card-gap: var(--homeos-card-grid-gap) !important; 
                }
                :host {
                  margin: 0px !important;
                }
              card:
                type: vertical-stack
                cards:
                  - type: custom:button-card     
                    entity: *config_garbage
                    template:
                      - template_garbage
                      - icon_trash_fill

                  - type: custom:button-card     
                    entity: *config_recycling
                    template:
                      - template_garbage
                      - icon_arrow3_trianglepath
        
# +----------------------------------------------------------------------------+
# | Washer Dryer Area Definition                                               |
# +----------------------------------------------------------------------------+
            - type: custom:mod-card
              view_layout:
                grid-area: washer
              style: |
                ha-card {
                  display: contents;   
                }
                :host {
                  margin: 0px !important;
                }
              card: !include homeos_module/washer_dryer/washer_dryer_card.yaml     

# +----------------------------------------------------------------------------+
# | Person in car Area Definition                                              |
# +----------------------------------------------------------------------------+
            - type: custom:mod-card
              view_layout:
                grid-area: person_car
              style: |
                ha-card {
                  display: contents;   
                }
                :host {
                  margin: 0px !important;
                }             
              card:
                  type: custom:button-card
                  entity: *config_person_car
                  variables:
                    var_travel_home: *config_travel_home
                    var_travel_work: *config_travel_work
                  triggers_update: *config_travel_home
                  template:
                    - template_person_car
                    - icon_car_fill
                    - icon_direction_house_work

# +----------------------------------------------------------------------------+
# | Person in Bus Area Definition                                              |
# +----------------------------------------------------------------------------+
            - type: custom:mod-card
              view_layout:
                grid-area: person_bus
              style: |
                ha-card {
                  display: contents;   
                }
                :host {
                  margin: 0px !important;
                }             
              card:
                  type: custom:button-card
                  entity: *config_person_bus
                  variables:
                    bus_sensor: *config_bus_route
                  triggers_update: *config_bus_route
                  template:
                    - template_person_bus
                    - icon_bus_fill

# +----------------------------------------------------------------------------+
# | Package Area Definition                                                    |
# +----------------------------------------------------------------------------+

            - type: custom:mod-card
              view_layout:
                grid-area: box
              style: |
                ha-card {
                  display: contents;   
                }
                :host {
                  margin: 0px !important;
                }             
              card:
                type: vertical-stack
                cards:
                  - type: custom:homeos-delivery-card
                    entities:
                      - sensor.seventeentrack_packages_delivered
                      - sensor.seventeentrack_packages_ready_to_be_picked_up
                      - sensor.seventeentrack_packages_in_transit

# +----------------------------------------------------------------------------+
# | Plant Area Definition                                                      |
# +----------------------------------------------------------------------------+
            - type: custom:mod-card
              view_layout:
                grid-area: plant
              style: 
                .: >
                  :host {
                    margin: 0px !important;
                  }   
                swipe-card:
                  $: |
                    .swiper-container {
                      box-shadow: var(--homeos-card-box-shadow);
                      border-radius: var(--homeos-card-border-radius);
                      background-color: var(--homeos-card-background);
                      backdrop-filter: var(--homeos-card-backdrop-filter);
                      border-style: var(--homeos-card-border-style);
                      border-color: var(--homeos-card-border-color);
                      border-width: var(--homeos-card-border-width);
                    }
                    .swiper-pagination {
                      bottom: 0vw !important;
                    }   
                    .swiper-pagination-bullet-active {
                      --swiper-pagination-color: var(--homeos-icon-color-primary) !important;
                      opacity: 0.6 !important;  
                      width: 0.5vw;
                      height: 0.5vw;  
                    }
                    .swiper-pagination-bullets>span {
                      width: 0.5vw;
                      height: 0.5vw;
                      background: var(--homeos-icon-color-primary);
                    }         
              card:
                type: custom:swipe-card
                start_card: 1
                reset_after: 10
                parameters:
                  effect: cards
                  spaceBetween: 10
                  pagination:
                    type: "bullets"
                    clickable: true
                cards:
            
                  - type: custom:button-card
                    entity: *config_hum_plant_1
                    variables:     
                      var_custom_name: *config_plant_1
                      min_hum: *config_min_plant_1
                    template:
                      - template_plant

                  - type: custom:button-card
                    entity: *config_hum_plant_2
                    variables:     
                      var_custom_name: *config_plant_2
                      min_hum: *config_min_plant_2
                    template:
                      - template_plant

# +----------------------------------------------------------------------------+
# | Clock Area Definition                                                      |
# +----------------------------------------------------------------------------+
            - type: custom:button-card
              entity: sensor.time
              view_layout:
                grid-area: clock
              template:
                - template_clock

# +----------------------------------------------------------------------------+
# | Test Area Definition                                                       |
# +----------------------------------------------------------------------------+


            # - type: custom:decluttering-card
            #   view_layout:
            #     grid-area: test
            #   template: light
            #   variables:
            #     - entity: light.clarabedroom
            #     - entity2: light.clarabedroom


